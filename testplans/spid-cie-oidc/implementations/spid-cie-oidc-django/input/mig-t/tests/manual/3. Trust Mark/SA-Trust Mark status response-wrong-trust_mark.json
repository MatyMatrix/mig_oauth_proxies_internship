{
    "test": {
      "name": "Does the SA's trust mark status endpoint correctly refuses revocated or invalid Trust Marks",
      "description": "In order to check if the trust mark status endpoint of a TA or SA correctly refuses invalid trust marks, a invalid or revocated trust mark can be sent to the endpoint and the response analyzed",
      "type": "active",
      "sessions": [
        "s1"
      ],
      "operations": [
        {
          "session": "s1",
          "action": "start"
        },
        {
          "action": "intercept",
          "from session": "s1",
          "then": "forward",
          "message type": "Trust Mark status request SA",
          "message operations": [
            {
              "from": "body",
              "edit": "id",
              "in": "https://example.com/"
            }
          ]
        },
        {
          "action": "validate",
          "from session": "s1",
          "then": "forward",
          "message type": "Trust Mark status response SA",
          "checks": [
            {
              "message section": "body",
              "regex": "\"active\":\\s*false"
            }
          ]
        }
      ],
      "result": "correct flow s1"
    }
  }